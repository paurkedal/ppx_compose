description = "Composition Inlining"
version = "%%VERSION_NUM%%"

requires(ppx_driver) = "ocaml-migrate-parsetree"
archive(ppx_driver,byte) = "ppx_compose.cmo"
archive(ppx_driver,native) = "ppx_compose.cmx"
plugin(ppx_driver,byte) = "ppx_compose.cma"
plugin(ppx_driver,native) = "ppx_compose.cmxs"
ppx(-ppx_driver,-custom_ppx) = "./ppx_compose --as-ppx"

package "runtime" (
  version = "%%VERSION_NUM%%"
  description = "Non-inlined operators to supplement ppx_compose."
  requires = ""
  archive(byte) = "ppx_compose_runtime.cma"
  archive(native) = "ppx_compose_runtime.cmxa"
  plugin(byte) = "ppx_compose_runtime.cma"
  plugin(native) = "ppx_compose_runtime.cmxs"
  exists_if = "ppx_compose_runtime.cma"
)
